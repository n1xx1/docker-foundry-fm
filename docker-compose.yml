version: "3.2"

services:
  fm:
    build: ./Dockerfile.filebrowser
    user: "112:119"
    ports:
      - 127.0.0.1:${PORT_FM:-30001}:8080
    volumes:
      - data:/data
      - config:/config
    environment:
      - FB_BASEURL=/$PREFIX/fm
      - FB_ROOT=/data/Data
      - FB_REAL_PASSWORD=$ADMIN_PASSWORD
    restart: always
  vtt:
    image: felddy/foundryvtt:9
    ports:
      - 127.0.0.1:${PORT_VTT:-30000}:30000
    volumes:
      - data:/data
      - foundry-cache:/container_cache
    environment:
      - FOUNDRY_ROUTE_PREFIX=$PREFIX
      - FOUNDRY_ADMIN_KEY=$ADMIN_PASSWORD
      - CONTAINER_CACHE=/container_cache
      - FOUNDRY_UID=112
      - FOUNDRY_USERNAME
      - FOUNDRY_PASSWORD
      - FOUNDRY_LICENSE_KEY
      - FOUNDRY_MINIFY_STATIC_FILES=true
      - FOUNDRY_PROXY_PORT=80
    restart: always

volumes:
  data:
  config:
  foundry-cache:
    external: true
